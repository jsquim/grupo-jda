<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de PrÃ©stamos - Grupo JDA</title>
    
    <!-- Estilos CSS externos -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="card">
            <h1>ğŸ§® Simulador de PrÃ©stamos</h1>
            <p class="subtitle">Grupo de Ahorros JDA â€¢ Tasa: 10% anual â€¢ MÃ¡ximo: $4,000 â€¢ Plazo: hasta 36 meses</p>
        </div>

        <!-- Formulario de SimulaciÃ³n -->
        <div class="card">
            <div id="alert" class="alert"></div>

            <form id="simuladorForm">
                <!-- SelecciÃ³n de Socio -->
                <div class="form-group">
                    <label for="socioSelect">ğŸ‘¤ Socio solicitante *</label>
                    <select id="socioSelect" required>
                        <option value="">Seleccionar socio...</option>
                    </select>
                </div>

                <!-- Monto del PrÃ©stamo con Slider -->
                <div class="form-group">
                    <label for="monto">ğŸ’µ Monto del prÃ©stamo *</label>
                    <input 
                        type="number" 
                        id="monto" 
                        min="100" 
                        max="4000" 
                        step="50" 
                        value="2000"
                        required
                        style="margin-top: 10px;"
                    >
                </div>

                <!-- Plazo con Slider -->
                <div class="form-group">
                    <label for="plazo">ğŸ“… Plazo en meses *</label>

                    <input 
                        type="number" 
                        id="plazo" 
                        min="1" 
                        max="36" 
                        value="12"
                        required
                        style="margin-top: 10px;"
                    >
                </div>

                <!-- Observaciones -->
                <div class="form-group">
                    <label for="observaciones">ğŸ“ Observaciones (opcional)</label>
                    <textarea 
                        id="observaciones" 
                        placeholder="Motivo del prÃ©stamo, detalles adicionales..."
                        rows="3"
                    ></textarea>
                </div>

                <button type="submit" class="btn btn-primary">ğŸ“Š Simular PrÃ©stamo</button>
            </form>
        </div>

        <!-- Resultados de la SimulaciÃ³n -->
        <div id="resultados" style="display: none;">
            <div class="card">
                <h2>ğŸ“‹ Resumen del PrÃ©stamo</h2>
                
                <div class="summary-grid">
                    <!-- Nombre del Socio -->
                    <div class="summary-item summary-socio">
                        <div class="summary-label">ğŸ‘¤ Solicitante</div>
                        <div class="summary-value" id="resumenNombreSocio">-</div>
                    </div>
                    
                    <div class="summary-item">
                        <div class="summary-label">ğŸ’µ Monto solicitado</div>
                        <div class="summary-value" id="resumenMonto">$0.00</div>
                    </div>
                    
                    <div class="summary-item">
                        <div class="summary-label">ğŸ“… Plazo</div>
                        <div class="summary-value" id="resumenPlazo">0 meses</div>
                    </div>
                    
                    <div class="summary-item">
                        <div class="summary-label">ğŸ’° Cuota mensual</div>
                        <div class="summary-value" id="resumenCuota">$0.00</div>
                    </div>
                    
                    <div class="summary-item">
                        <div class="summary-label">ğŸ’¸ Total a pagar</div>
                        <div class="summary-value" id="resumenTotal">$0.00</div>
                    </div>
                    
                    <div class="summary-item">
                        <div class="summary-label">ğŸ“ˆ Total intereses</div>
                        <div class="summary-value" id="resumenIntereses">$0.00</div>
                    </div>
                    
                    <div class="summary-item">
                        <div class="summary-label">ğŸ“† Primera cuota</div>
                        <div class="summary-value" id="resumenPrimeraCuota" style="font-size: 1.3rem;">--</div>
                    </div>
                    
                    <div class="summary-item">
                        <div class="summary-label">ğŸ“Š Tasa de interÃ©s</div>
                        <div class="summary-value">10%</div>
                    </div>
                </div>

                <div class="precancelacion-info" id="precancelacionInfo">
                    <strong>âœ… InformaciÃ³n de PrecancelaciÃ³n:</strong><br>
                    PodrÃ¡s precancelar este prÃ©stamo despuÃ©s de pagar <strong id="cuotasMinimas">0</strong> cuotas 
                    (25% del total). Esto te permitirÃ¡ liquidar el saldo restante sin pagar los intereses futuros.
                </div>

                <div class="table-container">
                    <h3>ğŸ“Š Tabla de AmortizaciÃ³n Francesa</h3>
                    <table id="tablaAmortizacion">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Fecha</th>
                                <th>Saldo Inicial</th>
                                <th>Cuota</th>
                                <th>InterÃ©s</th>
                                <th>Capital</th>
                                <th>Saldo Final</th>
                            </tr>
                        </thead>
                        <tbody id="tablaBody">
                        </tbody>
                    </table>
                </div>

                <div style="margin-top: 30px;">
                    <button type="button" class="btn btn-success" id="btnEnviar">âœ… Enviar a AprobaciÃ³n</button>
                    <button type="button" class="btn btn-secondary" onclick="location.reload()">ğŸ”„ Nueva SimulaciÃ³n</button>
                </div>
            </div>
        </div>

        <!-- Loading Spinner -->
        <div id="loadingSpinner">
            <div class="spinner"></div>
            <p>Procesando solicitud...</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase.js"></script>
    <script src="simulador.js"></script>
</body>
</html>

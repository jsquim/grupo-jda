<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de PrÃ©stamos - Grupo JDA</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header con botÃ³n de Login Admin -->
        <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
                <div>
                    <h1>ğŸ§® Simulador de PrÃ©stamos</h1>
                    <p class="subtitle">Grupo de Ahorros JDA â€¢ Tasa: 10% anual â€¢ MÃ¡ximo: $4,000 â€¢ Plazo: hasta 36 meses</p>
                </div>
                <a href="login.html" class="btn btn-secondary" style="margin: 0;">
                    ğŸ” Login Administrador
                </a>
            </div>
        </div>

        <!-- Formulario de SimulaciÃ³n -->
        <div class="card">
            <div id="alert" class="alert"></div>

            <form id="simuladorForm">
                <!-- Monto del PrÃ©stamo -->
                <div class="form-group">
                    <label for="monto">ğŸ’µ Monto del prÃ©stamo *</label>
                    <input 
                        type="number" 
                        id="monto" 
                        min="100" 
                        max="4000" 
                        step="50" 
                        value="1000"
                        required
                        placeholder="Ej: 1500"
                    >
                    <div class="input-helper">Entre $100 y $4,000</div>
                </div>

                <!-- Plazo -->
                <div class="form-group">
                    <label for="plazo">ğŸ“… Plazo en meses *</label>
                    <input 
                        type="number" 
                        id="plazo" 
                        min="1" 
                        max="36" 
                        value="12"
                        required
                        placeholder="Ej: 12"
                    >
                    <div class="input-helper">Entre 1 y 36 meses</div>
                </div>

                <button type="submit" class="btn btn-primary">ğŸ“Š Simular PrÃ©stamo</button>
            </form>
        </div>

        <!-- Resultados de la SimulaciÃ³n -->
        <div id="resultados" style="display: none;">
            <div class="card">
                <h2>ğŸ“‹ Resumen del PrÃ©stamo</h2>
                
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-label">ğŸ’µ Monto solicitado</div>
                        <div class="summary-value" id="resumenMonto">$0.00</div>
                    </div>
                    
                    <div class="summary-item">
                        <div class="summary-label">ğŸ“… Plazo</div>
                        <div class="summary-value" id="resumenPlazo">0 meses</div>
                    </div>
                    
                    <div class="summary-item">
                        <div class="summary-label">ğŸ’° Cuota mensual</div>
                        <div class="summary-value" id="resumenCuota">$0.00</div>
                    </div>
                    
                    <div class="summary-item">
                        <div class="summary-label">ğŸ’¸ Total a pagar</div>
                        <div class="summary-value" id="resumenTotal">$0.00</div>
                    </div>
                    
                    <div class="summary-item">
                        <div class="summary-label">ğŸ“ˆ Total intereses</div>
                        <div class="summary-value" id="resumenIntereses">$0.00</div>
                    </div>
                    
                    <div class="summary-item">
                        <div class="summary-label">ğŸ“† Primera cuota</div>
                        <div class="summary-value" id="resumenPrimeraCuota" style="font-size: 1.3rem;">--</div>
                    </div>
                    
                    <div class="summary-item">
                        <div class="summary-label">ğŸ“Š Tasa de interÃ©s</div>
                        <div class="summary-value">10%</div>
                    </div>
                </div>

                <div class="precancelacion-info" id="precancelacionInfo">
                    <strong>âœ… InformaciÃ³n de PrecancelaciÃ³n:</strong><br>
                    PodrÃ¡s precancelar este prÃ©stamo despuÃ©s de pagar <strong id="cuotasMinimas">0</strong> cuotas 
                    (25% del total). Esto te permitirÃ¡ liquidar el saldo restante sin pagar los intereses futuros.
                </div>

                <div class="table-container">
                    <h3>ğŸ“Š Tabla de AmortizaciÃ³n Francesa</h3>
                    <table id="tablaAmortizacion">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Fecha</th>
                                <th>Saldo Inicial</th>
                                <th>Cuota</th>
                                <th>InterÃ©s</th>
                                <th>Capital</th>
                                <th>Saldo Final</th>
                            </tr>
                        </thead>
                        <tbody id="tablaBody">
                        </tbody>
                    </table>
                </div>

                <div style="margin-top: 30px;">
                    <button type="button" class="btn btn-success" id="btnEnviar">âœ… Enviar a AprobaciÃ³n</button>
                    <button type="button" class="btn btn-secondary" onclick="location.reload()">ğŸ”„ Nueva SimulaciÃ³n</button>
                </div>
            </div>
        </div>

        <!-- Modal para Solicitar Datos del Socio -->
        <div id="modalSocio" class="modal">
            <div class="modal-content">
                <h3>ğŸ‘¤ IdentificaciÃ³n del Solicitante</h3>
                <p>Para enviar la solicitud a aprobaciÃ³n, completa tus datos:</p>
                
                <div class="form-group">
                    <label for="nombreSocio">Nombre completo *</label>
                    <input 
                        type="text" 
                        id="nombreSocio" 
                        placeholder="Ej: Juan PÃ©rez GarcÃ­a"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="cedulaSocio">CÃ©dula *</label>
                    <input 
                        type="text" 
                        id="cedulaSocio" 
                        placeholder="Ej: 0912345678"
                        maxlength="10"
                        required
                    >
                    <div class="input-helper">10 dÃ­gitos sin guiones</div>
                </div>
                
                <button type="button" class="btn btn-success" id="btnConfirmarSocio">âœ… Confirmar y Enviar</button>
                <button type="button" class="btn btn-secondary" id="btnCancelarModal">âŒ Cancelar</button>
            </div>
        </div>

        <!-- Loading Spinner -->
        <div id="loadingSpinner">
            <div class="spinner"></div>
            <p>Procesando solicitud...</p>
        </div>
    </div>

    <!-- Scripts - ORDEN IMPORTANTE -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/config.js"></script>
    <script src="js/supabase-client.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/validations.js"></script>
    <script src="js/database.js"></script>
    <script src="js/simulador.js"></script>
</body>
</html>
